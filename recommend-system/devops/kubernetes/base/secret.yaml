# Secret 配置
# 存储敏感数据，如密码、API 密钥等
# 注意：实际部署时应使用 Sealed Secrets、Vault 或云厂商的 Secret Manager
---
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  labels:
    app.kubernetes.io/name: app-secrets
    app.kubernetes.io/part-of: generative-recsys
type: Opaque
stringData:
  # JWT 配置 - 用于 API 认证
  JWT_SECRET: "your-jwt-secret-key-change-in-production"
  JWT_EXPIRY: "24h"
  
  # API 密钥
  API_KEY: "your-api-key-change-in-production"
  
  # 加密密钥
  ENCRYPTION_KEY: "your-encryption-key-32-chars-min"
---
apiVersion: v1
kind: Secret
metadata:
  name: db-secrets
  labels:
    app.kubernetes.io/name: db-secrets
    app.kubernetes.io/part-of: generative-recsys
type: Opaque
stringData:
  # PostgreSQL 凭证
  POSTGRES_USER: "recommend_user"
  POSTGRES_PASSWORD: "change-this-password-in-production"
  
  # Redis 凭证
  REDIS_PASSWORD: "change-this-redis-password"
  
  # Milvus 凭证
  MILVUS_USER: "milvus_user"
  MILVUS_PASSWORD: "change-this-milvus-password"
  
  # Kafka 凭证
  KAFKA_SASL_USERNAME: "kafka_user"
  KAFKA_SASL_PASSWORD: "change-this-kafka-password"
---
apiVersion: v1
kind: Secret
metadata:
  name: registry-credentials
  labels:
    app.kubernetes.io/name: registry-credentials
    app.kubernetes.io/part-of: generative-recsys
type: kubernetes.io/dockerconfigjson
data:
  # Base64 编码的 Docker registry 凭证
  # 实际使用时需要替换为真实的凭证
  .dockerconfigjson: eyJhdXRocyI6eyJyZWdpc3RyeS5leGFtcGxlLmNvbSI6eyJ1c2VybmFtZSI6InVzZXIiLCJwYXNzd29yZCI6InBhc3N3b3JkIiwiYXV0aCI6ImRYTmxjanB3WVhOemQyOXlaQT09In19fQ==
---
apiVersion: v1
kind: Secret
metadata:
  name: llm-secrets
  labels:
    app.kubernetes.io/name: llm-secrets
    app.kubernetes.io/part-of: generative-recsys
type: Opaque
stringData:
  # LLM API 密钥 (用于冷启动服务)
  LLM_API_KEY: "your-llm-api-key"
  
  # OpenAI 兼容接口密钥
  OPENAI_API_KEY: "your-openai-compatible-key"
---
apiVersion: v1
kind: Secret
metadata:
  name: tls-secrets
  labels:
    app.kubernetes.io/name: tls-secrets
    app.kubernetes.io/part-of: generative-recsys
type: kubernetes.io/tls
data:
  # TLS 证书 - 实际部署时使用 cert-manager 自动管理
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFekNDQWZ1Z0F3SUJBZ0lKQUt4NVNFZ0VQdkZITUEwR0NTcUdTSWIzRFFFQkN3VUFNQnd4R2pBWUJnTlYKQkFNTUVYSmxZMjl0YldWdVpDNWxlR0Z0Y0d4bE1CNFhEVEkwTURFeE1EQXdNREF3TUZvWERUSTFNREV3T1RBdwpNREF3TUZvd0hERWFNQmdHQTFVRUF3d1JjbVZqYjIxdFpXNWtMbVY0WVcxd2JHVXdnZ0VpTUEwR0NTcUdTSWIzCkRRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQzFhMjNQbHlBY0JHZEZ5RzNhN2c2MjdmZ0JrMEFLZFBpd2xZRWoKMW5vNUFQTUxZZ0dSWjN6ckFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQzFhMjNQbHlBY0JHZEYKeUczYTdnNjI3ZmdCazBBS2RQaXdsWUVqMW5vNUFQTUxZZ0dSWjN6ckFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQQpBQUFBQUE9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==
---
# ExternalSecret 模板 (用于与外部 Secret 管理器集成)
# 取消注释以启用 External Secrets Operator
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: external-app-secrets
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     kind: ClusterSecretStore
#     name: vault-backend
#   target:
#     name: app-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: JWT_SECRET
#       remoteRef:
#         key: secret/recommend/app
#         property: jwt_secret
#     - secretKey: API_KEY
#       remoteRef:
#         key: secret/recommend/app
#         property: api_key

