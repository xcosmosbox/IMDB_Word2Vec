# Kustomization 配置
# 定义基础资源和通用配置
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: recommend-system-base
  annotations:
    config.kubernetes.io/local-config: "true"

# 命名空间 (由 overlays 覆盖)
namespace: recommend-system

# 通用标签
commonLabels:
  app.kubernetes.io/part-of: generative-recsys
  app.kubernetes.io/managed-by: kustomize

# 通用注解
commonAnnotations:
  app.kubernetes.io/version: "1.0.0"

# 资源列表
resources:
  - namespace.yaml
  - configmap.yaml
  - secret.yaml
  - deployment.yaml
  - service.yaml
  - hpa.yaml
  - pdb.yaml
  - pvc.yaml

# 镜像配置 (由 overlays 覆盖)
images:
  - name: recommend-service
    newName: registry.example.com/recommend/recommend-service
    newTag: latest
  - name: user-service
    newName: registry.example.com/recommend/user-service
    newTag: latest
  - name: item-service
    newName: registry.example.com/recommend/item-service
    newTag: latest
  - name: ugt-inference
    newName: registry.example.com/recommend/ugt-inference
    newTag: latest
  - name: user-app
    newName: registry.example.com/recommend/user-app
    newTag: latest
  - name: admin-app
    newName: registry.example.com/recommend/admin-app
    newTag: latest

# ConfigMap 生成器
configMapGenerator:
  - name: version-config
    literals:
      - VERSION=1.0.0
      - BUILD_DATE=2025-01-05
      - GIT_COMMIT=unknown

# Secret 生成器 (示例)
# secretGenerator:
#   - name: generated-secrets
#     literals:
#       - RANDOM_KEY=changeme

# 配置变换
configurations:
  - config/label-transformer.yaml
  - config/annotation-transformer.yaml

# 替换配置
replacements: []

# 变量引用
vars: []

# 补丁
patches: []

# 生成选项
generatorOptions:
  disableNameSuffixHash: false
  labels:
    generated: "true"
  annotations:
    note: "Generated by Kustomize"

